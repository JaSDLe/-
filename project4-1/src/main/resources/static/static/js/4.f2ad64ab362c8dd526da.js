webpackJsonp([4],{Awkx:function(e,t,i){var s={"./AdmBasic.vue":"Gb5X"};function a(e){return i(n(e))}function n(e){var t=s[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}a.keys=function(){return Object.keys(s)},a.resolve=n,e.exports=a,a.id="Awkx"},Gb5X:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={data:function(){var e=this;return{users:[],keywords:"",dialogTitle:"",multipleSelection:[],pageSize:10,totalCount:-1,currentPage:1,dialogVisible:!1,tableLoading:!1,isDisabled:!0,user:{username:"",name:"",password:"",checkPass:""},rules:{username:[{validator:function(e,t,i){if(!t)return i(new Error("请输入用户名"));i()},trigger:"blur"}],name:[{validator:function(e,t,i){if(!t)return i(new Error("请输入姓名"));i()},trigger:"blur"}],password:[{validator:function(t,i,s){0==e.isDisabled&&(""===i||null==i?s(new Error("请输入密码")):e.$refs.addUserForm.validateField("checkPass")),s()},trigger:"blur"}],checkPass:[{validator:function(t,i,s){0==e.isDisabled&&(""===i||null==i?s(new Error("请再次输入密码")):i!==e.user.password?s(new Error("两次输入密码不一致!")):s()),s()},trigger:"blur"}]},options:[],value:""}},mounted:function(){this.loadUsers(),this.loadRoles()},methods:{loadRoles:function(){var e=this;this.getRequest("/system/basic/roles").then(function(t){if(t&&200==t.status){var i=t.data;e.options=i}})},loadUsers:function(){var e=this,t=this;this.tableLoading=!0,this.getRequest("/admin/basic/user?page="+this.currentPage+"&size="+this.pageSize+"&keywords="+this.keywords).then(function(i){if(e.tableLoading=!1,i&&200==i.status){var s=i.data;t.users=s.users,t.totalCount=s.count}})},showEditUserView:function(e){this.isDisabled=!1,this.dialogTitle="编辑用户",this.user.id=e.id,this.user.username=e.username,this.user.name=e.name,this.value=e.roles[0].id,this.dialogVisible=!0},showAddUserView:function(){this.isDisabled=!0,this.dialogTitle="添加用户",this.dialogVisible=!0},addUser:function(e){var t=this,i=this;this.tableLoading=!0,this.user.id?""==this.user.password&&""==this.user.checkPass||null==this.user.password&&null==this.user.checkPass?this.putRequest("/admin/basic/?role_id="+this.value,this.user).then(function(e){i.tableLoading=!1,e&&200==e.status&&(i.dialogVisible=!1,i.emptyUserData(),i.loadUsers())}):this.$refs[e].validate(function(e){e&&t.putRequest("/admin/basic/?role_id="+t.value,t.user).then(function(e){i.tableLoading=!1,e&&200==e.status&&(i.dialogVisible=!1,i.emptyUserData(),i.loadUsers())})}):this.$refs[e].validate(function(e){e&&t.postRequest("/admin/basic/user/reg?role_id="+t.value,t.user).then(function(e){i.tableLoading=!1,e&&200==e.status&&(i.dialogVisible=!1,i.emptyUserData(),i.loadUsers())})}),i.tableLoading=!1},handleSelectionChange:function(e){this.multipleSelection=e},deleteManyUsers:function(){var e=this;this.$confirm("此操作将删除["+this.multipleSelection.length+"]条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){for(var t="",i=0;i<e.multipleSelection.length;i++)t+=e.multipleSelection[i].id+",";e.doDelete(t)}).catch(function(){})},deleteUser:function(e){var t=this;this.$confirm("此操作将永久删除["+e.name+"], 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.doDelete(e.id)}).catch(function(){})},doDelete:function(e){this.tableLoading=!0;var t=this;this.deleteRequest("/admin/basic/user/"+e).then(function(e){t.tableLoading=!1,e&&200==e.status?(t.currentPage=1,t.loadUsers()):t.$message({type:"error",message:"删除的数据与别的表有关联，删除失败！"})})},keywordsChange:function(e){""==e&&(this.currentPage=1,this.loadUsers())},searchUser:function(){this.loadUsers()},handleCurrentChange:function(e){this.currentPage=e,this.loadUsers()},handleSizeChange:function(e){this.pageSize=e,this.currentPage=1,this.loadUsers()},cancelEidt:function(e){this.dialogVisible=!1,this.emptyUserData(),this.$refs.addUserForm.clearValidate()},handleDialogClose:function(e){this.emptyUserData(),this.$refs.addUserForm.clearValidate(),e()},emptyUserData:function(){this.user={username:"",name:"",password:"",checkPass:""},this.value=""}}},a={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("el-container",[i("el-header",{staticStyle:{padding:"0px",display:"flex","justify-content":"space-between","align-items":"center"}},[i("div",{staticStyle:{display:"inline"}},[i("el-input",{staticStyle:{width:"300px",margin:"0px",padding:"0px"},attrs:{placeholder:"请输入姓名",clearable:"",size:"small","prefix-icon":"el-icon-search"},on:{change:e.keywordsChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchUser(t)}},model:{value:e.keywords,callback:function(t){e.keywords=t},expression:"keywords"}}),e._v(" "),i("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary",size:"small",icon:"el-icon-search"},on:{click:e.searchUser}},[e._v("搜索")])],1),e._v(" "),i("div",{staticStyle:{"margin-left":"5px","margin-right":"20px",display:"inline"}},[i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.showAddUserView}},[e._v("添加用户")])],1)]),e._v(" "),i("el-main",{staticStyle:{"padding-left":"0px","padding-top":"0px"}},[i("div",[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],staticStyle:{width:"100%"},attrs:{data:e.users,border:"",resizable:"",stripe:"",size:"medium"},on:{"selection-change":e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"index",align:"center",label:" ",width:"38"}}),e._v(" "),i("el-table-column",{attrs:{type:"selection",align:"center",width:"40"}}),e._v(" "),i("el-table-column",{attrs:{prop:"name",align:"left","show-overflow-tooltip":"",label:"姓名"}}),e._v(" "),i("el-table-column",{attrs:{prop:"username",align:"left","show-overflow-tooltip":"",label:"用户名"}}),e._v(" "),i("el-table-column",{attrs:{prop:"roles[0].nameZh",align:"left","show-overflow-tooltip":"",label:"角色"}}),e._v(" "),i("el-table-column",{attrs:{fixed:"right",align:"center",width:"150","show-overflow-tooltip":"",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{staticStyle:{padding:"3px 4px 3px 4px",margin:"2px"},attrs:{type:"warning",icon:"el-icon-edit",size:"mini"},on:{click:function(i){return e.showEditUserView(t.row)}}},[e._v("修改")]),e._v(" "),i("el-button",{staticStyle:{padding:"3px 4px 3px 4px",margin:"2px"},attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(i){return e.deleteUser(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("div",{staticStyle:{display:"flex","justify-content":"space-between","margin-top":"10px"}},[e.users.length>0?i("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete",disabled:0==e.multipleSelection.length},on:{click:e.deleteManyUsers}},[e._v("批量删除")]):e._e(),e._v(" "),i("el-pagination",{attrs:{background:"","page-size":e.pageSize,"page-sizes":[10,5,20,30],"current-page":e.currentPage,layout:"total, prev, pager, next, sizes, jumper",total:e.totalCount},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1)])],1),e._v(" "),i("el-dialog",{staticStyle:{padding:"0px","text-align":"left"},attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.dialogVisible,"before-close":e.handleDialogClose,width:"500px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{ref:"addUserForm",staticStyle:{margin:"0px",padding:"0px"},attrs:{model:e.user,rules:e.rules}},[i("el-form-item",{attrs:{label:"用户名:",prop:"username"}},[i("el-input",{attrs:{"prefix-icon":"el-icon-edit",type:"text",clearable:"",placeholder:"请输入用户名"},model:{value:e.user.username,callback:function(t){e.$set(e.user,"username","string"==typeof t?t.trim():t)},expression:"user.username"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"姓名:",prop:"name"}},[i("el-input",{attrs:{"prefix-icon":"el-icon-edit",clearable:"",placeholder:"请输入姓名"},model:{value:e.user.name,callback:function(t){e.$set(e.user,"name","string"==typeof t?t.trim():t)},expression:"user.name"}})],1),e._v(" "),i("el-form-item",{staticStyle:{"padding-top":"20px"},attrs:{prop:"role"}},[i("el-select",{attrs:{placeholder:"请选择角色"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,function(e){return i("el-option",{key:e.id,attrs:{label:e.nameZh,value:e.id}})}),1)],1),e._v(" "),i("el-form-item",{attrs:{label:"密码",prop:"password"}},[i("el-input",{attrs:{type:"password",disabled:e.isDisabled,placeholder:"请输入密码",clearable:"","show-password":""},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password","string"==typeof t?t.trim():t)},expression:"user.password"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"确认密码",prop:"checkPass"}},[i("el-input",{attrs:{type:"password",disabled:e.isDisabled,placeholder:"请再次输入密码",clearable:"","show-password":""},model:{value:e.user.checkPass,callback:function(t){e.$set(e.user,"checkPass","string"==typeof t?t.trim():t)},expression:"user.checkPass"}})],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.cancelEidt("addUserForm")}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.addUser("addUserForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var n=i("VU/8")(s,a,!1,function(e){i("c/qR")},null,null);t.default=n.exports},"c/qR":function(e,t){}});
//# sourceMappingURL=4.f2ad64ab362c8dd526da.js.map